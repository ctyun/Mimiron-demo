<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>components\BSSFrame\sidebar.js - Mimiron</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Mimiron" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AbstractECharts.html">AbstractECharts</a></li>
                                <li><a href="../classes/Ajax.html">Ajax</a></li>
                                <li><a href="../classes/Autocomplete.html">Autocomplete</a></li>
                                <li><a href="../classes/AutoSelect.html">AutoSelect</a></li>
                                <li><a href="../classes/BasicArea.html">BasicArea</a></li>
                                <li><a href="../classes/BasicColumn.html">BasicColumn</a></li>
                                <li><a href="../classes/BasicLine.html">BasicLine</a></li>
                                <li><a href="../classes/BasicPie.html">BasicPie</a></li>
                                <li><a href="../classes/BSSForm.html">BSSForm</a></li>
                                <li><a href="../classes/BSSFrame.html">BSSFrame</a></li>
                                <li><a href="../classes/BSSPanel.html">BSSPanel</a></li>
                                <li><a href="../classes/Button.html">Button</a></li>
                                <li><a href="../classes/CascadeSelect.html">CascadeSelect</a></li>
                                <li><a href="../classes/Checkbox.html">Checkbox</a></li>
                                <li><a href="../classes/CheckboxGroup.html">CheckboxGroup</a></li>
                                <li><a href="../classes/DatePicker.html">DatePicker</a></li>
                                <li><a href="../classes/Demo.html">Demo</a></li>
                                <li><a href="../classes/ECharts.html">ECharts</a></li>
                                <li><a href="../classes/ExpressionSelect.html">ExpressionSelect</a></li>
                                <li><a href="../classes/FlowMaker.html">FlowMaker</a></li>
                                <li><a href="../classes/Grid.html">Grid</a></li>
                                <li><a href="../classes/Grid2.html">Grid2</a></li>
                                <li><a href="../classes/Header.html">Header</a></li>
                                <li><a href="../classes/Input.html">Input</a></li>
                                <li><a href="../classes/IrregularLine.html">IrregularLine</a></li>
                                <li><a href="../classes/message.html">message</a></li>
                                <li><a href="../classes/MessageBox.html">MessageBox</a></li>
                                <li><a href="../classes/Modal.html">Modal</a></li>
                                <li><a href="../classes/PageButton.html">PageButton</a></li>
                                <li><a href="../classes/PageItem.html">PageItem</a></li>
                                <li><a href="../classes/Pager.html">Pager</a></li>
                                <li><a href="../classes/PageSizeSelect.html">PageSizeSelect</a></li>
                                <li><a href="../classes/QueryPanel.html">QueryPanel</a></li>
                                <li><a href="../classes/Select.html">Select</a></li>
                                <li><a href="../classes/SideBar.html">SideBar</a></li>
                                <li><a href="../classes/StackedArea.html">StackedArea</a></li>
                                <li><a href="../classes/StackedColumn.html">StackedColumn</a></li>
                                <li><a href="../classes/StackedLine.html">StackedLine</a></li>
                                <li><a href="../classes/Tab.html">Tab</a></li>
                                <li><a href="../classes/TablePanel.html">TablePanel</a></li>
                                <li><a href="../classes/Tabs.html">Tabs</a></li>
                                <li><a href="../classes/TencentMap.html">TencentMap</a></li>
                                <li><a href="../classes/Textarea.html">Textarea</a></li>
                                <li><a href="../classes/ToolBarPanel.html">ToolBarPanel</a></li>
                                <li><a href="../classes/TopBar.html">TopBar</a></li>
                                <li><a href="../classes/Treeview.html">Treeview</a></li>
                                <li><a href="../classes/TreeWithTable.html">TreeWithTable</a></li>
                                <li><a href="../classes/window.html">window</a></li>
                                <li><a href="../classes/WordCloud.html">WordCloud</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/BSSFrame.html">BSSFrame</a></li>
                                <li><a href="../modules/demo.html">demo</a></li>
                                <li><a href="../modules/ECharts.html">ECharts</a></li>
                                <li><a href="../modules/ETL.html">ETL</a></li>
                                <li><a href="../modules/html.html">html</a></li>
                                <li><a href="../modules/message.html">message</a></li>
                                <li><a href="../modules/page.html">page</a></li>
                                <li><a href="../modules/panel.html">panel</a></li>
                                <li><a href="../modules/tabs.html">tabs</a></li>
                                <li><a href="../modules/TencentMap.html">TencentMap</a></li>
                                <li><a href="../modules/tree.html">tree</a></li>
                                <li><a href="../modules/utils.html">utils</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: components\BSSFrame\sidebar.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module BSSFrame
 */

var React = require(&#x27;react&#x27;);
var API = require(&quot;../const/API&quot;);
var Debug = require(&quot;../utils/debug&quot;);
var Ajax = require(&quot;../utils/ajax&quot;);

var H5 = require(&quot;../utils/h5&quot;);
/*
 * 由Route取代, 这里是临时使用
 */
var Link = React.createClass({
	displayName: &quot;Link&quot;,
	getDefaultProps: function(){
        return{
        	to:&quot;#&quot;,
        }
    },
	render: function(){
		return(&lt;a href={this.props.to} onClick={this._onClick} data-tohash=&quot;yes&quot;&gt;
				{this.props.children}
			&lt;/a&gt;)
	},
    _onClick: function(e){
        e.preventDefault();
        this.renewSelect(this.props.to);
    },
    renewSelect: function(){
        $(&quot;li&quot;).removeClass(&quot;active&quot;);
        $(&quot;a[href=&#x27;&quot;+this.props.to+&quot;&#x27;]&quot;).parent().addClass(&quot;active&quot;);
    }
})

/**
 *
 * 侧边目录组件, 可以实现异步不刷新加载.jsx文件, 正确使用此组件需要下列条件:
 * 1. 使用\static\third目录下的JSXTransformer.js
 * 2. 在全局暴露Mimiron.RouteConfig, 保存路由信息, 例子如下:
 * &#x60;&#x60;&#x60;
 * Mimiron.RouteConfig = {
    &quot;../js/pages/index.jsx&quot;:/^\/$/ig,
    &quot;../js/pages/sample.jsx&quot;:/sample$/ig,
    &quot;../js/pages/login.jsx&quot;:/login$/ig,
    &quot;../js/pages/manage-report-group.jsx&quot;:/report\/manageReportGroup/ig,
    &quot;../js/pages/report-manage.jsx&quot;:/report\/manage$/ig,
    &quot;../js/pages/report-config.jsx&quot;:/report\/config/ig,
    &quot;../js/pages/metadata.jsx&quot;:/report\/metadata/ig,
    &quot;../js/pages/show-report.jsx&quot;:/showReport\/[^\/*]/ig
    }
 * &#x60;&#x60;&#x60;
 * &#x60;&#x60;&#x60;
 * 组件示例:
 * &lt;SideBar list={this.props.menu} /&gt;
 * &#x60;&#x60;&#x60;
 * 组件有一个静态方法, 需要在页面框架组件的componentDidMount声明周期进行调用:
 * &#x60;Sidebar.init(&quot;../js/dist/frame/theme.js&quot;);&#x60;
 * 该方法有一个必选参数, 是主题的配置文件路径.
 * 
 * @class SideBar
 * 
 */ 
var SideBar = React.createClass({
    displayName: &#x27;SideBar&#x27;,
    getInitialState:function(){
		return {
            selectFlag:false,
			menu:null,
            list:[{}],
		}
	},
    componentWillMount: function(){
        var self = this;
        //从API中取登录用户可用的菜单
        var result = H5.localStorage.get(&quot;SideBar&quot;);
        if(result){
            this.FormSidebar(self,result);
            window.setTimeout(&quot;clickMenu()&quot;,200); //理论上可以立即操作, 但是实践中, jquery可以找到目标元素, 但是点击没有任何反应.
            return;
        }
    	Ajax.get(API.SIDE_BAR_MENU,function(d){
    		if(d){
                self.state.list = d.children;
            }
            self.FormSidebar(self,self.state.list);
            H5.localStorage.set(&quot;SideBar&quot;,self.state.list);
        });
    },
    componentDidMount: function(){
        window.clickMenu = function(url){
            var url = url||window.location.hash;
            url = url.split(&quot;/&quot;);
            url = &quot;/&quot;+url[1]+&quot;/&quot;+url[2]; 
            var targetOpt = $(&quot;a[href=&#x27;&quot;+url+&quot;&#x27;]&quot;);
            if(targetOpt){
                if(targetOpt.parent().parent().prev().prop(&quot;tagName&quot;)==&quot;A&quot;){
                    var targetParent = targetOpt.parent().parent().prev();
                    if(targetParent.parent().parent().prev().prop(&quot;tagName&quot;)==&quot;A&quot;){
                        var targetGrandpa = targetParent.parent().parent().prev();
                        targetGrandpa.trigger(&quot;click&quot;);
                        targetParent.trigger(&quot;click&quot;);
                        targetOpt.parent().addClass(&quot;active&quot;);
                    }else{
                        targetParent.trigger(&quot;click&quot;);
                        targetOpt.parent().addClass(&quot;active&quot;);
                    }
                }else{
                    targetOpt.parent().addClass(&quot;active&quot;);
                }
            }
        }
        //update之后调用
        //clickMenu();
    },
    componentDidUpdate : function(prevProps,prevState){
        if(this.state.selectFlag){
            window.setTimeout(&quot;clickMenu()&quot;,200); //理论上可以立即操作, 但是实践中, jquery可以找到目标元素, 但是点击没有任何反应.
        }
    },
    render: function () {
        return (&lt;div&gt;
			    &lt;nav id=&quot;sidebar&quot; role=&quot;navigation&quot; className=&quot;navbar-default navbar-static-side&quot;&gt;
	            &lt;div className=&quot;sidebar-collapse menu-scroll&quot;&gt;
	                &lt;ul id=&quot;side-menu&quot; className=&quot;nav&quot;&gt;
	                	&lt;li&gt;&lt;/li&gt;
	                    {this.state.menu}
	                &lt;/ul&gt;
	            &lt;/div&gt;
	        &lt;/nav&gt;
        &lt;/div&gt;);
    },
    dummyClick: function(e){
        //e.preventDefault();
    },
    FormSidebar: function(self,result){
        var list = self.props.list || result;
        var menu = (list &amp;&amp; list.length) ? list.map(function(item, key) {
            if (item.children&amp;&amp;item.children.length==0&amp;&amp;item.url&amp;&amp;item.url.length&gt;0) {
                return &lt;li key={key}&gt;&lt;Link to={item.url}&gt;&lt;span className=&quot;menu-title&quot;&gt;{item.name}&lt;/span&gt;&lt;/Link&gt;&lt;/li&gt;
            } else {
                if (item.children &amp;&amp; item.children.length&gt;0) {
                    return (
                        &lt;li key={key}&gt;
                            &lt;a href=&quot;#&quot; onClick={self.dummyClick}&gt;
                                &lt;span className=&quot;menu-title&quot;&gt;{item.name}&lt;/span&gt;
                                &lt;span className=&quot;fa fa-arrow arrow&quot;&gt;&lt;/span&gt;
                            &lt;/a&gt;
                            &lt;ul className=&quot;nav nav-second-level mtn collapse&quot;&gt;
                                {item.children.map(function(sub, subKey) {

                                    if (sub.url&amp;&amp;sub.url.length&gt;0) {
                                        return &lt;li key={subKey}&gt;
                                            &lt;Link to={sub.url}&gt;&lt;i className=&quot;fa fa-angle-right&quot;&gt;&lt;/i&gt;&lt;span className=&quot;submenu-title&quot;&gt;{sub.name}&lt;/span&gt;&lt;/Link&gt;
                                        &lt;/li&gt;
                                    } else {
                                        if (sub.children &amp;&amp; sub.children.length&gt;0) {
                                            return (
                                                &lt;li key={subKey}&gt;
                                                    &lt;a href=&quot;#&quot; &gt;
                                                        &lt;i className=&quot;fa fa-angle-right&quot;&gt;&lt;/i&gt;
                                                        &lt;span className=&quot;submenu-title&quot;&gt;{sub.name}&lt;/span&gt;
                                                        &lt;span className=&quot;fa fa-arrow arrow&quot;&gt;&lt;/span&gt;
                                                    &lt;/a&gt;
                                                    &lt;ul className=&quot;nav nav-third-level mtn collapse&quot;&gt;
                                                    {sub.children.map(function(third, thirdKey) {
                                                        return &lt;li key={thirdKey}&gt;
                                                            &lt;Link to={third.url}&gt;
                                                                &lt;i className=&quot;fa fa-angle-double-right&quot;&gt;&lt;/i&gt;
                                                                &lt;span className=&quot;submenu-title&quot;&gt;{third.name}&lt;/span&gt;
                                                            &lt;/Link&gt;
                                                        &lt;/li&gt;
                                                    })}
                                                    &lt;/ul&gt;
                                                &lt;/li&gt;
                                            )
                                        }
                                    }
                                    if(sub.url&amp;&amp;sub.url.length&gt;0){
                                        return &lt;li key={subKey}&gt;
                                         &lt;Link to={sub.url}&gt;{sub.name}&lt;/Link&gt;
                                        &lt;/li&gt;
                                    }
                                })}
                            &lt;/ul&gt;
                        &lt;/li&gt;
                    )
                }
            }
        }) : false;
        self.setState({menu:menu,selectFlag:true});
    }
});

module.exports = SideBar;
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
